{ 
    "AWSTemplateFormatVersion":"2010-09-09",
    "Description":"",
    "Parameters":{ 
       "WEBDnsEndpoint":{ 
          "AllowedPattern":"^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
          "Description":"The DNS endpoint - WEB Public ELB DNS name.",
          "Type":"String"
       },
       "APIDnsEndpoint":{ 
          "AllowedPattern":"^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
          "Description":"The DNS endpoint - API Public ELB DNS name.",
          "Type":"String"
       },
       "WEBHostedZoneID":{ 
          "Description":"The DNS host zone id of WebApp",
          "Type":"String"
       },
       "APIHostedZoneID":{ 
          "Description":"The DNS host zone id of API",
          "Type":"String"
       },
       "MainDomainName":{ 
          "AllowedPattern":"^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
          "Description":"The main domain name (e.g. example.com).",
          "Type":"String"
       },
       "WEBSubDomainPrefix":{ 
          "AllowedPattern":"^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
          "Description":"The prefix of sub domain name of the WebApp (e.g. web).",
          "Type":"String"
       },
       "APISubDomainPrefix":{ 
          "AllowedPattern":"^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
          "Description":"The prefix of sub domain name of the API (e.g. api).",
          "Type":"String"
       }
    },
    "Resources":{ 
       "WEBRecordSet":{ 
          "Type":"AWS::Route53::RecordSetGroup",
          "Properties":{ 
             "HostedZoneName":{ 
                "Fn::Join":[ 
                   "",
                   [ 
                      { 
                         "Ref":"MainDomainName"
                      },
                      "."
                   ]
                ]
             },
             "RecordSets":[ 
                { 
                   "Name":{ 
                      "Fn::Join":[ 
                         "",
                         [ 
                            { 
                               "Ref":"WEBSubDomainPrefix"
                            },
                            ".",
                            { 
                               "Ref":"MainDomainName"
                            },
                            "."
                         ]
                      ]
                   },
                   "Type":"A",
                   "AliasTarget":{ 
                      "DNSName":{ 
                         "Ref":"WEBDnsEndpoint"
                      },
                      "EvaluateTargetHealth":true,
                      "HostedZoneId":{ 
                         "Ref":"WEBHostedZoneID"
                      }
                   }
                }
             ]
          }
       },
       "APIRecordSet":{ 
          "Type":"AWS::Route53::RecordSetGroup",
          "Properties":{ 
             "HostedZoneName":{ 
                "Fn::Join":[ 
                   "",
                   [ 
                      { 
                         "Ref":"MainDomainName"
                      },
                      "."
                   ]
                ]
             },
             "RecordSets":[ 
                { 
                   "Name":{ 
                      "Fn::Join":[ 
                         "",
                         [ 
                            { 
                               "Ref":"APISubDomainPrefix"
                            },
                            ".",
                            { 
                               "Ref":"MainDomainName"
                            },
                            "."
                         ]
                      ]
                   },
                   "Type":"A",
                   "AliasTarget":{ 
                      "DNSName":{ 
                         "Ref":"APIDnsEndpoint"
                      },
                      "EvaluateTargetHealth":true,
                      "HostedZoneId":{ 
                         "Ref":"APIHostedZoneID"
                      }
                   }
                }
             ]
          }
       }
    }
 }